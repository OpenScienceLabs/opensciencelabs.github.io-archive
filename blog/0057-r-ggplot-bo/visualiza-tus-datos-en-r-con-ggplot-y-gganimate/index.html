<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Visualiza tus datos en R con ggplot2 y gganimate | Open Science Labs</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="es" href="../../../rss.xml">
<link rel="canonical" href="https://opensciencelabs.org/blog/0057-r-ggplot-bo/visualiza-tus-datos-en-r-con-ggplot-y-gganimate/">
<link rel="icon" href="../../../favicon.ico" sizes="16x16">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163785882-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163785882-1');
</script><link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
<meta name="author" content="Ever Vino">
<meta property="description" content="Una gr√°fica es una buena manera de expresar los datos, estos ayudan a ver detalles que simplemente pueden pasar desapercibidos cuando s√≥lo se los analizan numericamente, estos pueden tener a√∫n mayor i">
<link rel="prev" href="../../0058-nfts-article1/nft-mas-que-un-jpg/" title="NFT. M√°s que un JPG" type="text/html">
<link rel="next" href="../../0056-openscienceframework/que-es-el-open-science-framework/" title="Que es el Open Science Framework?" type="text/html">
<meta property="og:site_name" content="Open Science Labs">
<meta property="og:title" content="Visualiza tus datos en R con ggplot2 y gganimate">
<meta property="og:url" content="https://opensciencelabs.org/blog/0057-r-ggplot-bo/visualiza-tus-datos-en-r-con-ggplot-y-gganimate/">
<meta property="og:description" content="Una gr√°fica es una buena manera de expresar los datos, estos ayudan a ver detalles que simplemente pueden pasar desapercibidos cuando s√≥lo se los analizan numericamente, estos pueden tener a√∫n mayor i">
<meta property="og:image" content="https://opensciencelabs.org/images/logo.jpg">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-04-08T00:00:00-05:00">
<meta property="article:tag" content="r">
<meta property="article:tag" content="visualization">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@opensciencelabs">
<meta property="twitter:image" content="https://opensciencelabs.org/images/logo.jpg">
<link rel="stylesheet" href="../../../assets/css/osl.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../../">
            <img src="../../../images/logo.png" alt="Open Science Labs" id="logo" class="d-inline-block align-top"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../../" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../../" class="nav-link">Blog</a>
                </li>
<li class="nav-item">
<a href="../../../guidelines/list" class="nav-link">Guidelines</a>
                </li>
<li class="nav-item">
<a href="../../../about/" class="nav-link">About</a>

                
            </li>
</ul>
<form class="navbar-form navbar-left" action="../../../search" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search‚Ä¶" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;"><!-- button type="submit" class="btn btn-default">Submit</button -->
</form>


            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">
                <a href="." class="u-url">Visualiza tus datos en R con ggplot2 y gganimate</a>
            </h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                         <a class="u-url" href="../../../authors/ever-vino/">Ever Vino</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2019-04-08T00:00:00-05:00" itemprop="datePublished" title="2019-04-08">2019-04-08</time></a>
            </p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/pages/blog/0057-r-ggplot-bo/ArticuloGgplotenR.html">Comentarios</a>


            

        </p>
</div>
        
        <ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/r/" rel="tag">r</a></li>
            <li><a class="tag p-category" href="../../../categories/visualization/" rel="tag">visualization</a></li>
        </ul></header><div class="e-content entry-content" itemprop="articleBody text">
        <!-- # Visualiza tus datos en R con ggplot2 y gganimate -->
<!-- **Autor**: [Ever Vino](../../authors/ever-vino.md) -->

<p><img alt="header" src="../../../images/blog/visualiza-tus-datos-en-r-con-ggplot-y-gganimate/header.png"></p>
<p>Una gr√°fica es una buena manera de expresar los datos, estos ayudan a ver detalles que simplemente pueden pasar desapercibidos cuando s√≥lo se los analizan numericamente, estos pueden tener a√∫n mayor impacto si estan animados. ¬øPor qu√© no hacerlo?. En este art√≠culo se describe como hacer animaci√≥n usando ggplot2 y gganimate en R.</p>
<!-- TEASER_END -->

<h3>Comenzando üöÄ</h3>
<p>Usamos R por ser un lenguaje especializado para ciencia de datos y tener una gran Comunidad Open Source. Antes de comenzar recomendamos tener las versiones actualizadas de R y su IDE RStudio.</p>
<p><em>Puedes descargar R y RStudio desde sus p√°ginas web oficiales:</em></p>
<p><a href="https://cran.r-project.org/">cran.r-project.org</a></p>
<p><a href="https://www.rstudio.com/">rstudio.org</a></p>
<h4>Instalaci√≥n de pre-requisitos üîß üìã</h4>
<p>Para este ejemplo se usan las librer√≠as de <code>rio</code>, <code>dplyr</code>, <code>ggplot2</code> y <code>gganimate</code>. Para instalarlas se ejecutan las siguientes l√≠neas de c√≥digo en R
<em>(Recuerde que para ejecutar una linea de Comando en el Editor de RStudio Es con Ctrl+Enter o puede escribirlo directamento en la Consola)</em></p>
<pre class="code literal-block"><span></span><code><span class="n">install</span><span class="o">.</span><span class="n">package</span><span class="p">(</span><span class="n">rio</span><span class="p">)</span>        <span class="c1">#librer√≠a para importar archivos csv o xlsx</span>
<span class="n">install</span><span class="o">.</span><span class="n">package</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>      <span class="c1">#librer√≠a para filtrar datos</span>
<span class="n">install</span><span class="o">.</span><span class="n">package</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>    <span class="c1">#librer√≠a para realizar las gr√°ficas</span>
<span class="n">install</span><span class="o">.</span><span class="n">package</span><span class="p">(</span><span class="n">gganimate</span><span class="p">)</span>  <span class="c1">#librer√≠a para realizar la animaci√≥n</span>
</code></pre>

<h3>Preparaci√≥n de los datos para graficar ‚öôÔ∏è</h3>
<p>En nuestro ejemplo usaremos la base de datos del INE "Importaciones de Productos y Art√≠culos de Bolivia 1992-2021p"
Abrimos nuestras librer√≠as con:</p>
<pre class="code literal-block"><span></span><code><span class="n">library</span><span class="p">(</span><span class="n">rio</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">gganimate</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</code></pre>

<p>Importamos los datos a un objeto llamado libro con:</p>
<pre class="code literal-block"><span></span><code><span class="n">libro</span><span class="o">&lt;-</span><span class="n">import</span><span class="p">(</span><span class="s2">".my/path/DatosImportacionBolivia1992-2021.csv"</span><span class="p">)</span>
</code></pre>

<p>Para ver la cabecera del libro y para ver la estructura del libro libro ejecutamos respectivamente <code>head(libro)</code> y <code>str(libro)</code></p>
<pre class="code literal-block"><span></span><code><span class="o">&gt;</span> <span class="n">head</span><span class="p">(</span><span class="n">libro</span><span class="p">)</span>
       <span class="n">Fecha</span> <span class="n">ALIMENTOS</span> <span class="n">Y</span> <span class="n">BEBIDAS</span> <span class="n">SUMINISTROS</span> <span class="n">INDUSTRIALES</span> <span class="n">COMBUSTIBLES</span> <span class="n">Y</span> <span class="n">LUBRICANTES</span>
<span class="mi">1</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>           <span class="mf">12.686477</span>                 <span class="mf">30.38827</span>                   <span class="mf">1.738607</span>
<span class="mi">2</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>            <span class="mf">9.139570</span>                 <span class="mf">32.57593</span>                   <span class="mf">1.822906</span>
<span class="mi">3</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span>            <span class="mf">6.150201</span>                 <span class="mf">21.37546</span>                   <span class="mf">2.000110</span>
<span class="mi">4</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span>            <span class="mf">9.225652</span>                 <span class="mf">28.34524</span>                   <span class="mf">1.455245</span>
<span class="mi">5</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">01</span>           <span class="mf">14.503611</span>                 <span class="mf">22.06801</span>                   <span class="mf">2.168646</span>
<span class="mi">6</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">01</span>            <span class="mf">5.875804</span>                 <span class="mf">25.43617</span>                   <span class="mf">3.084602</span>
  <span class="n">BIENES</span> <span class="n">DE</span> <span class="n">CAPITAL</span> <span class="n">EQUIPO</span> <span class="n">DE</span> <span class="n">TRANSPORTE</span> <span class="n">Y</span> <span class="n">SUS</span> <span class="n">PIEZAS</span> <span class="n">Y</span> <span class="n">ACCESORIOS</span> <span class="n">ART√çCULOS</span> <span class="n">DE</span> <span class="n">CONSUMO</span>
<span class="mi">1</span>          <span class="mf">25.66374</span>                                       <span class="mf">22.20454</span>             <span class="mf">5.585219</span>
<span class="mi">2</span>          <span class="mf">22.00027</span>                                       <span class="mf">18.68626</span>             <span class="mf">6.528652</span>
<span class="mi">3</span>          <span class="mf">22.92478</span>                                       <span class="mf">17.40578</span>             <span class="mf">6.196415</span>
<span class="mi">4</span>          <span class="mf">31.14429</span>                                       <span class="mf">16.77957</span>             <span class="mf">5.422824</span>
<span class="mi">5</span>          <span class="mf">26.82719</span>                                       <span class="mf">22.79343</span>             <span class="mf">5.458318</span>
<span class="mi">6</span>          <span class="mf">23.47011</span>                                       <span class="mf">16.00698</span>             <span class="mf">5.647866</span><span class="n">_</span>
</code></pre>

<pre class="code literal-block"><span></span><code><span class="o">&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">libro</span><span class="p">)</span>
<span class="s1">'data.frame'</span><span class="p">:</span>   <span class="mi">358</span> <span class="n">obs</span><span class="o">.</span> <span class="n">of</span>  <span class="mi">7</span> <span class="n">variables</span><span class="p">:</span>
 <span class="err">$</span> <span class="n">Fecha</span>                                         <span class="p">:</span> <span class="n">IDate</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s2">"1992-01-01"</span> <span class="s2">"1992-02-01"</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">ALIMENTOS</span> <span class="n">Y</span> <span class="n">BEBIDAS</span>                           <span class="p">:</span> <span class="n">num</span>  <span class="mf">12.69</span> <span class="mf">9.14</span> <span class="mf">6.15</span> <span class="mf">9.23</span> <span class="mf">14.5</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">SUMINISTROS</span> <span class="n">INDUSTRIALES</span>                      <span class="p">:</span> <span class="n">num</span>  <span class="mf">30.4</span> <span class="mf">32.6</span> <span class="mf">21.4</span> <span class="mf">28.3</span> <span class="mf">22.1</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">COMBUSTIBLES</span> <span class="n">Y</span> <span class="n">LUBRICANTES</span>                    <span class="p">:</span> <span class="n">num</span>  <span class="mf">1.74</span> <span class="mf">1.82</span> <span class="mi">2</span> <span class="mf">1.46</span> <span class="mf">2.17</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">BIENES</span> <span class="n">DE</span> <span class="n">CAPITAL</span>                             <span class="p">:</span> <span class="n">num</span>  <span class="mf">25.7</span> <span class="mi">22</span> <span class="mf">22.9</span> <span class="mf">31.1</span> <span class="mf">26.8</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">EQUIPO</span> <span class="n">DE</span> <span class="n">TRANSPORTE</span> <span class="n">Y</span> <span class="n">SUS</span> <span class="n">PIEZAS</span> <span class="n">Y</span> <span class="n">ACCESORIOS</span><span class="p">:</span> <span class="n">num</span>  <span class="mf">22.2</span> <span class="mf">18.7</span> <span class="mf">17.4</span> <span class="mf">16.8</span> <span class="mf">22.8</span> <span class="o">...</span>
 <span class="err">$</span> <span class="n">ART√çCULOS</span> <span class="n">DE</span> <span class="n">CONSUMO</span>                          <span class="p">:</span> <span class="n">num</span>  <span class="mf">5.59</span> <span class="mf">6.53</span> <span class="mf">6.2</span> <span class="mf">5.42</span> <span class="mf">5.46</span> <span class="o">...</span>
</code></pre>

<p>Es importante verificar el tipo de dato antes de graficar, en este caso nos importa que la fecha tenga formato de IDate y los dem√°s sean tengan formato de num.</p>
<p>Con las siguientes lineas de c√≥digo se compactamos el n√∫mero de columnas de nuestro libro en un nuevo objeto llamado datos <em>(Notese que solamente utilizaremos las primeras 4 columnas del objeto libro).</em> Es decir una columna para la fecha, una columna para su valor y otra columna que muestre su clasificaci√≥n.</p>
<pre class="code literal-block"><span></span><code><span class="c1">#Simplificando nuestra tabla para realizar las gr√°ficas</span>
<span class="c1">#Cuando se escribe el nombre del objeto libro$.. en RStudio el autocomplado con los nombres de la columnas del libro</span>
<span class="n">datos</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">Fecha</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">libro</span><span class="err">$</span><span class="n">Fecha</span><span class="p">,</span><span class="n">libro</span><span class="err">$</span><span class="n">Fecha</span><span class="p">,</span><span class="n">libro</span><span class="err">$</span><span class="n">Fecha</span><span class="p">,</span><span class="n">libro</span><span class="err">$</span><span class="n">Fecha</span><span class="p">),</span>
                   <span class="n">Valor</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">libro</span><span class="err">$`</span><span class="n">ALIMENTOS</span> <span class="n">Y</span> <span class="n">BEBIDAS</span><span class="err">`</span><span class="p">,</span>
                             <span class="n">libro</span><span class="err">$`</span><span class="n">SUMINISTROS</span> <span class="n">INDUSTRIALES</span><span class="err">`</span><span class="p">,</span>
                             <span class="n">libro</span><span class="err">$`</span><span class="n">COMBUSTIBLES</span> <span class="n">Y</span> <span class="n">LUBRICANTES</span><span class="err">`</span><span class="p">,</span>
                             <span class="n">libro</span><span class="err">$`</span><span class="n">EQUIPO</span> <span class="n">DE</span> <span class="n">TRANSPORTE</span> <span class="n">Y</span> <span class="n">SUS</span> <span class="n">PIEZAS</span> <span class="n">Y</span> <span class="n">ACCESORIOS</span><span class="err">`</span><span class="p">),</span>
                    <span class="n">Clasificacion</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="n">rep</span><span class="p">(</span><span class="s2">"Alimentos y Bebidas"</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">libro</span><span class="p">)),</span>
                               <span class="n">rep</span><span class="p">(</span><span class="s2">"Suministros Industriales"</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">libro</span><span class="p">)),</span>
                               <span class="n">rep</span><span class="p">(</span><span class="s2">"Combustibles y Lubricantes"</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">libro</span><span class="p">)),</span>
                               <span class="n">rep</span><span class="p">(</span><span class="s2">"Equipo de Transporte"</span><span class="p">,</span><span class="n">nrow</span><span class="p">(</span><span class="n">libro</span><span class="p">))</span>
</code></pre>

<p>Funciones auxiliares usadas:</p>
<ul>
<li>
<p><code>libro$columna</code> para acceder al columna del libro.</p>
</li>
<li>
<p><code>data.frame(columna1, columna2 ...)</code> para crear una nuevo objeto de Datos.</p>
</li>
<li>
<p><code>c(elemento1, elemento2, ...)</code> para juntar elementos en un vector.</p>
</li>
<li>
<p><code>rep(elemento, n_veces)</code> para generar un vector con el elemento repetido n_veces.</p>
</li>
<li>
<p><code>nrow(tabla)</code> para obtener el n√∫mero de filas de tabla.</p>
</li>
</ul>
<p>Veamos la cabecera de nuestro obejto datos con <code>head(datos)</code> :</p>
<pre class="code literal-block"><span></span><code><span class="o">&gt;</span> <span class="n">head</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
       <span class="n">Fecha</span>    <span class="n">Valor</span>       <span class="n">Clasificacion</span>
<span class="mi">1</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mf">56.34888</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
<span class="mi">2</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span> <span class="mf">47.42231</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
<span class="mi">3</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span> <span class="mf">59.54501</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
<span class="mi">4</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span> <span class="mf">56.08808</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
<span class="mi">5</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">01</span> <span class="mf">51.86330</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
<span class="mi">6</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">01</span> <span class="mf">43.84668</span> <span class="n">Alimentos</span> <span class="n">y</span> <span class="n">Bebidas</span>
</code></pre>

<h3>Gr√°fica est√°tica ‚öôÔ∏è</h3>
<p>Para graficar con <code>ggplot2</code> es conveniente entender que esta librer√≠a a√±ade sus componentes en layers (capas), estos layers son objetos a los cuales se le puede modificar su apariencia y especificar de donde extraer sus valores.</p>
<p>Asignamos a un objeto ggplot llamado p1 lo que vamos a graficar</p>
<pre class="code literal-block"><span></span><code><span class="c1">#Modificando el theme</span>
<span class="n">theme_set</span><span class="p">(</span><span class="n">theme_bw</span><span class="p">())</span>

<span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">datos</span><span class="p">)</span><span class="o">+</span>
  <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Fecha</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Valor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Clasificacion</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">theme</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">)</span><span class="o">+</span>
  <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">"Fecha"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Valor en MM Bs"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span>
       <span class="n">title</span> <span class="o">=</span> <span class="s2">"Datos de Importaci√≥n de Bolivia 1991-2021p"</span><span class="p">,</span>
       <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">"Expresado en Millones de Bolivianos"</span><span class="p">)</span>
<span class="n">p1</span>
</code></pre>

<p>Funciones utilizadas</p>
<ul>
<li>
<p><code>theme_set(theme_bw())</code>
  Modifica el conjunto de colores usado en el tema para realizar la gr√°fica.</p>
</li>
<li>
<p><code>ggplot(data)</code>Esta es la primera capa a utilizarse inicialmente le asignamos nuestos datos para que cree las dimensiones de las coordenadas.</p>
</li>
<li>
<p><code>geom_line(aes(x, y, color), size)</code> Capa que hereda los datos de ggplot() y se los puede usar  directamente con el nombre de sus columnas, grafica los datos "x" e "y" como l√≠neas y las clasifica deacuerdo al "color" y "size" determina el grosor de sus l√≠neas.</p>
</li>
<li>
<p><code>theme(legend.position)</code>Capa que modifica la posici√≥n de la leyenda dentro gr√°fico con "legend.position", esta puede adquirir valores de "top", "left", etc.</p>
</li>
<li>
<p><code>labs(x, y, color, title, subtitle)</code>Capa que pone los nombres a eje "x" y al eje "y", adem√°s de poner el nombre encima de las leyendas con "color", el nombre t√≠tulo y subt√≠tulo con "title" y "subtitle" respectivamente.</p>
</li>
</ul>
<p><img alt="alt text" src="../../../images/blog/visualiza-tus-datos-en-r-con-ggplot-y-gganimate/Rplot.png"></p>
<h3>Gr√°fica Animada ‚öôÔ∏è</h3>
<p>Ya teniendo nuestra nuestra gr√°fica est√°tica vamos a realizar algunas modificaciones para que se resalte los datos de nuestro inter√©s.</p>
<p>Filtrando datos con fecha mayor al a√±o 2019.</p>
<pre class="code literal-block"><span></span><code><span class="n">datos</span><span class="o">&lt;-</span><span class="nb">filter</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span><span class="n">datos</span><span class="err">$</span><span class="n">Fecha</span><span class="o">&gt;=</span><span class="k">as</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="s2">"2019-01-01"</span><span class="p">))</span>
</code></pre>

<ul>
<li>
<p><code>filter(datos, condicion)</code> evalua cada fila de datos y filtra de acuerdo a la condicion.</p>
</li>
<li>
<p><code>as.Date(var)</code> convierte var a un formato de fecha Date</p>
</li>
</ul>
<p>Agregando un nuevo data frame periodos para resaltar las fechas de confinamiento por Covid19.</p>
<pre class="code literal-block"><span></span><code><span class="n">periodos</span><span class="o">&lt;-</span><span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">xmin</span> <span class="o">=</span> <span class="k">as</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="s2">"2020-03-22"</span><span class="p">),</span> <span class="n">xmax</span> <span class="o">=</span> <span class="k">as</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="s2">"2020-08-31"</span><span class="p">),</span>
                     <span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="n">Inf</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">Inf</span><span class="p">,</span> <span class="n">Periodo</span> <span class="o">=</span> <span class="s2">"Confinamiento por COVID19"</span><span class="p">)</span>
</code></pre>

<p>Creando un nuevo objeto <code>ggplot2</code> p2 para incluir las nuevas modificaciones.</p>
<pre class="code literal-block"><span></span><code><span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">datos</span><span class="p">)</span><span class="o">+</span>
  <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Fecha</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Valor</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Clasificacion</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">geom_rect</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">periodos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">aes</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">ymax</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Periodo</span><span class="p">))</span><span class="o">+</span>
  <span class="n">theme</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">)</span><span class="o">+</span>
  <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">"Fecha"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Valor en MM Bs"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">""</span> <span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span>
       <span class="n">title</span> <span class="o">=</span> <span class="s2">"Datos de Importaci√≥n Bolivia 2019-2021p"</span><span class="p">,</span>
       <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">"Expresado en Millones de Bolivianos"</span><span class="p">)</span>
<span class="n">p2</span>
</code></pre>

<ul>
<li>
<p><code>geom_rect(data, alpha, aes(xmin, xmax, ymin, ymax, fill))</code> dibuja un rectangulo a partir de los datos en "Data",
  modifica su opacidad de acuerdo a "alpha",
  extrae los datos de acuerdo a "xmin, xmax, ymin, ymax",
  y los clasifica de acuerdo a "fill".</p>
</li>
<li>
<p><code>lab(fill)</code> pone el nombre encima de la leyenda de los rect√°ngulos dibujados.</p>
</li>
</ul>
<p>Con las modificaciones ya hechas con en p2, creamos el objeto <code>gganimate</code> anim el cu√°l contendr√° nuestra grafico a animar.</p>
<pre class="code literal-block"><span></span><code><span class="n">anim</span> <span class="o">&lt;-</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">transition_reveal</span><span class="p">(</span><span class="n">Fecha</span><span class="p">)</span> <span class="o">+</span>
  <span class="n">geom_label</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="k">as</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="s2">"2019-06-01"</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mi">280</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">format</span><span class="p">(</span><span class="n">datos</span><span class="err">$</span><span class="n">Fecha</span><span class="p">,</span><span class="s2">"%Y"</span><span class="p">)),</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">"gray"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</code></pre>

<ul>
<li>
<p><code>transition_reveal(var)</code> A√±ade la animacion transition_reveal() usando como referencia la variable "var".</p>
</li>
<li>
<p><code>geom_label((aes(x,y,label)) col, size)</code>
  A√±ade la la etiqueta del a√±o dentro de la gr√°fica
  aes(x, y, label) "x" e "y" son las coordenadas donde se grafica la etiqueta "label", con "col" seleccionamos un color y con "size" el tama√±o.</p>
</li>
</ul>
<p><em>Nota: geom_label() fu√© dise√±ado para graficar etiquetas que acompa√±en a la gr√°fica. En este ejemplo en espec√≠fico fu√© usado como una etiqueta est√°tica fijando sus coordenadas "x" e "y" en un s√≥lo punto. Se opt√≥ por esta opci√≥n ya que genera un buen impacto visual.</em></p>
<p>Con el objeto anim creato podemos invocar la funci√≥n animate de <code>gganimate</code>. Una vez ejecutada la funci√≥n animate() se abrir√° una ventana con el resultado en formato .gif.</p>
<pre class="code literal-block"><span></span><code><span class="n">animate</span><span class="p">(</span><span class="n">anim</span><span class="p">,</span> <span class="n">fps</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_pause</span> <span class="o">=</span> <span class="mi">30</span> <span class="p">)</span>
</code></pre>

<ul>
<li>
<code>animate(anim, fps, duration, width, height, end_pause)</code> de la funci√≥n "anim" objeto a animarse
  "fps" cantidad de frames por segundo,
  "duration" duraci√≥n de la animaci√≥n en segundos,
  "with" "height" ancho y alto de la animaci√≥n respectivamente en pixeles,
  "end_pause" cantidad de veces a repetirse el √∫ltimo frame para la animaci√≥n.</li>
</ul>
<p>Hay casos en los que extra√±amente no se instalan los renders para hacer la renderizaci√≥n de la animaci√≥n y aparece un error al tratar de ejecutar el c√≥digo arriba mostrado, en ese caso puede probar con la siguiente soluci√≥n: Ejecute en modo administrador RStudio e instale los renders con <code>install.packages("gifski")</code> para el render que viene por defecto con <code>gganimate</code>, tambien puede instalar el render magick con <code>install.packages("magick")</code> para tener otra opci√≥n para renderizar. Para saber que opciones tiene el render magick ejecute <code>help("magick_renderer")</code> y se le mostrara su breve manual.</p>
<p><img alt="alt text" src="datosimportpandemia.gif"></p>
<p>Despues de ver la animaci√≥n podemos guardarla haciendo:</p>
<pre class="code literal-block"><span></span><code><span class="n">archivo</span><span class="o">&lt;-</span><span class="n">animate</span><span class="p">(</span><span class="n">anim</span><span class="p">,</span> <span class="n">fps</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">end_pause</span> <span class="o">=</span> <span class="mi">30</span> <span class="p">)</span>
<span class="n">anim_save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">"datosimportpandemia.gif"</span><span class="p">,</span> <span class="n">animation</span> <span class="o">=</span> <span class="n">archivo</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="s2">".my/path/save/"</span><span class="p">)</span>
</code></pre>

<p><code>anim_save(filename, animation, path)</code>
Guarda el renderizado de "animation" con el nombre "filename" en la ruta "path".</p>
<p><a href="https://github.com/OpenScienceLabs/articles/tree/main/articles/0057-r-ggplot-bo">Descarga los archivos de este ejemplo</a></p>
<h3>Referencias üìÑ</h3>
<ul>
<li>
<a href="https://www.ine.gob.bo">Instituto Nacional de Estad√≠stica Bolivia</a> üì¢</li>
<li><a href="https://www.rdocumentation.org">Documentacion de R</a></li>
</ul>
<hr>
</div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../../0058-nfts-article1/nft-mas-que-un-jpg/" rel="prev" title="NFT. M√°s que un JPG">Publicaci√≥n anterior</a>
            </li>

            <li class="archive">
                <a href="../../../archive.html" rel="archive" title="Archive ">Archivo</a>
            </li>

            <li class="next">
                <a href="../../0056-openscienceframework/que-es-el-open-science-framework/" rel="next" title="Que es el Open Science Framework?">Siguiente publicaci√≥n</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comentarios</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nikolademo",
            disqus_url="https://opensciencelabs.org/blog/0057-r-ggplot-bo/visualiza-tus-datos-en-r-con-ggplot-y-gganimate/",
        disqus_title="Visualiza tus datos en R con ggplot2 y gganimate",
        disqus_identifier="cache/pages/blog/0057-r-ggplot-bo/ArticuloGgplotenR.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="nikolademo";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents ¬© 2022         <a href="../../../team">Open Science Labs Team</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
